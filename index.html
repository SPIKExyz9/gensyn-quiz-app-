<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Gensyn Ã— SpikeXYZ â€” Quiz</title>
<meta name="description" content="Gensyn X SpikeXYZ quiz â€” decentralized AI compute quiz with leaderboard and sharing." />
<meta name="theme-color" content="#0b0212" />
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='18' fill='%23FF2DA8'/><text x='50' y='57' font-size='40' text-anchor='middle' fill='white' font-family='Arial'>S</text></svg>">

<style>
  :root{
    --bg1:#0b0212;
    --accent1:#ff2da8;
    --accent2:#7b3cff;
    --muted:#bfb7d8;
    --card:#0f0720cc;
    --glass: rgba(255,255,255,0.04);
  }
  html,body{height:100%;}
  body{
    margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background: radial-gradient(1200px 400px at 10% 20%, rgba(123,60,255,0.11), transparent 6%),
                radial-gradient(900px 300px at 90% 80%, rgba(255,45,170,0.08), transparent 8%),
                linear-gradient(180deg,var(--bg1),#050007);
    color:#fff; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* Decorative hex grid backdrop */
  .hex-backdrop{
    position:fixed; inset:0; z-index:0; pointer-events:none;
    background-image: radial-gradient(ellipse at center, rgba(0,0,0,0.16), transparent 40%),
      linear-gradient(90deg, rgba(255,45,170,0.06), rgba(123,60,255,0.03));
    mask-image: linear-gradient(to bottom, transparent 0%, black 12%, black 88%, transparent 100%);
  }
  /* glowing hex pattern */
  .hex-grid{
    position: absolute; inset:0; background-size: 70px 70px;
    background-image:
      linear-gradient(120deg, rgba(255,255,255,0.03) 1px, transparent 1px),
      linear-gradient(60deg, rgba(255,255,255,0.03) 1px, transparent 1px);
    opacity:.6; mix-blend-mode: overlay; filter: blur(8px) saturate(120%);
    transform: scale(1.02);
  }

  .container{position:relative; z-index:2; max-width:920px; margin:24px auto; padding:18px;}
  header{
    display:flex; align-items:center; gap:12px; justify-content:space-between;
    margin-bottom:18px;
  }
  .brand{display:flex; gap:12px; align-items:center;}
  .logo{
    width:56px; height:56px; border-radius:10px; padding:8px; background: linear-gradient(135deg,var(--accent1),var(--accent2));
    box-shadow: 0 6px 24px rgba(139,65,255,0.28), inset 0 -6px 18px rgba(0,0,0,.18);
    display:grid; place-items:center; font-weight:700; font-size:18px;
  }
  .brand h1{font-size:18px; margin:0; letter-spacing:0.6px;}
  .brand p{margin:0;font-size:11px;color:var(--muted);}

  .top-actions{display:flex; gap:10px; align-items:center;}
  .btn{
    border:0; padding:10px 14px; border-radius:12px; font-weight:600; font-size:14px; cursor:pointer;
    background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
    color:white; box-shadow: 0 6px 18px rgba(0,0,0,0.5);
  }
  .btn.primary{
    background: linear-gradient(90deg,var(--accent1),var(--accent2));
    box-shadow: 0 10px 30px rgba(123,60,255,0.26);
    transform: translateZ(0);
  }

  /* card */
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:18px; padding:18px; box-shadow: 0 12px 40px rgba(4,3,12,0.6);
    border: 1px solid rgba(255,255,255,0.03);
    backdrop-filter: blur(6px) saturate(120%);
  }

  .hero{
    display:flex; gap:16px; align-items:center; justify-content:space-between; padding:18px;
    margin-bottom:12px;
  }
  .hero-left{max-width:62%;}
  .headline{font-size:28px; margin:0 0 6px 0; letter-spacing: -0.02em;}
  .sub{color:var(--muted); margin:0 0 12px 0;font-size:13px;}

  .start-btn{display:inline-block; padding:12px 18px; border-radius:14px; font-weight:700; font-size:16px;}
  .meta{
    display:flex; gap:8px; align-items:center; color:var(--muted); font-size:13px;
  }

  /* quiz area */
  .quiz{
    margin-top:10px;
  }
  .progress-wrap{height:10px; background:rgba(255,255,255,0.04); border-radius:999px; overflow:hidden; margin-bottom:12px;}
  .progress{height:100%; width:0%; background: linear-gradient(90deg,var(--accent1),var(--accent2)); transition:width 600ms cubic-bezier(.2,.9,.2,1);}

  .question{
    font-size:18px; font-weight:700; padding:12px 0;
  }
  .options{display:grid; gap:10px;}
  .option{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,0.03);
    font-weight:600; cursor:pointer; transition:transform .15s ease, box-shadow .15s ease;
  }
  .option:hover{ transform: translateY(-4px); box-shadow: 0 18px 36px rgba(0,0,0,0.6);}
  .option.correct{outline: 3px solid rgba(120,255,180,0.18); box-shadow: 0 8px 30px rgba(0,200,120,0.06);}
  .option.wrong{opacity:.75; transform: translateX(4px);}

  .footer-row{display:flex; justify-content:space-between; align-items:center; margin-top:12px; gap:8px;}
  .small{font-size:13px;color:var(--muted);}

  /* leaderboard modal */
  .modal{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:50; visibility:hidden; opacity:0; transition:all .2s;}
  .modal.show{visibility:visible; opacity:1;}
  .modal-panel{width:calc(100% - 32px); max-width:720px; border-radius:14px; padding:14px;}

  /* table */
  table{width:100%; border-collapse:collapse;}
  th,td{padding:10px; text-align:left; font-size:14px;}
  th{color:var(--muted); font-weight:600; font-size:12px;}
  tr + tr td{border-top:1px solid rgba(255,255,255,0.03);}

  /* confetti canvas */
  #confetti { position:fixed; inset:0; pointer-events:none; z-index:60; }

  /* responsive */
  @media (max-width:520px){
    .hero-left{max-width:100%;}
    .headline{font-size:22px;}
    .logo{width:48px;height:48px;font-size:16px;}
  }
</style>
</head>
<body>
<div class="hex-backdrop">
  <div class="hex-grid"></div>
</div>

<div class="container">
  <header>
    <div class="brand">
      <div class="logo" aria-hidden>
        <!-- Inline SVG SpikeXYZ mark -->
        <svg width="36" height="36" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="g1" x1="0" x2="1">
              <stop offset="0" stop-color="#FF2DA8"/><stop offset="1" stop-color="#7B3CFF"/>
            </linearGradient>
          </defs>
          <rect x="6" y="6" rx="16" ry="16" width="88" height="88" fill="url(#g1)"/>
          <path d="M30 65 L50 28 L70 65 Z" fill="rgba(255,255,255,0.95)"/>
        </svg>
      </div>
      <div>
        <h1>SpikeXYZ</h1>
        <p>Gensyn Ã— SpikeXYZ â€” Quiz Arena</p>
      </div>
    </div>

    <div class="top-actions">
      <button id="leaderBtn" class="btn">Leaderboard</button>
      <button id="exportBtn" class="btn">Export</button>
      <button id="startBtn" class="btn primary start-btn">Start Quiz</button>
    </div>
  </header>

  <main class="card" role="main">
    <section class="hero">
      <div class="hero-left">
        <h2 class="headline">Quiz Website â€” Gensyn Ã— SpikeXYZ</h2>
        <p class="sub">Test your knowledge on decentralized AI compute. Earn a place on the leaderboard â€” challenge friends and share your results.</p>
        <div class="meta">
          <span class="small">25 Questions â€¢ Random order â€¢ Mobile-optimized</span>
        </div>
      </div>
      <div style="text-align:right">
        <div style="font-size:12px;color:var(--muted);margin-bottom:8px">Current Streak</div>
        <div style="background:linear-gradient(90deg,var(--accent1),var(--accent2)); padding:10px 14px; border-radius:12px; font-weight:800; box-shadow: 0 8px 24px rgba(123,60,255,0.14);">ðŸ”¥ <span id="streak">0</span></div>
      </div>
    </section>

    <section id="quizArea" class="quiz" aria-live="polite">
      <div class="progress-wrap" aria-hidden><div id="progress" class="progress"></div></div>

      <div id="qcard" class="card" style="padding:14px; margin-bottom:6px;">
        <div class="question" id="question">Press <strong>Start Quiz</strong> to begin.</div>
        <div class="options" id="options" aria-hidden></div>

        <div class="footer-row">
          <div class="small">Score: <strong id="score">0</strong> â€¢ Correct: <span id="correct">0</span> / <span id="attempted">0</span></div>
          <div>
            <button id="nextBtn" class="btn" style="display:none">Next</button>
            <button id="endBtn" class="btn" style="display:none">End</button>
          </div>
        </div>
      </div>

      <div style="display:flex; gap:10px; justify-content:space-between; align-items:center;">
        <div class="small">Winning Rate: <strong id="winningRate">0%</strong></div>
        <div style="display:flex; gap:10px;">
          <button id="shareBtn" class="btn">Share Result</button>
          <button id="resetBtn" class="btn">Reset</button>
        </div>
      </div>
    </section>
  </main>
</div>

<!-- Leaderboard modal -->
<div id="modal" class="modal">
  <div class="modal-panel card">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
      <h3 style="margin:0">Leaderboard</h3>
      <div>
        <button id="closeModal" class="btn">Close</button>
      </div>
    </div>
    <div style="display:flex; gap:8px; margin-bottom:8px;">
      <input id="nameInput" placeholder="Your name (for leaderboard)" style="flex:1;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
      <button id="saveScore" class="btn primary">Save Score</button>
    </div>

    <div style="overflow:auto; max-height:360px;">
      <table id="boardTable" aria-live="polite">
        <thead><tr><th>#</th><th>Name</th><th>Score</th><th>Correct</th><th>Rate</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
    <div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end">
      <button id="importBtn" class="btn">Import</button>
      <button id="clearBoard" class="btn">Clear</button>
    </div>
  </div>
</div>

<canvas id="confetti"></canvas>

<script>
/* ========= QUIZ DATA (25 questions) =========
   Each item: {q, options:[A,B,C,D], a: indexOfCorrect (0..3)}
*/
const QUESTIONS = [
{q:"What is Gensyn primarily known for?", options:["Cloud gaming","Decentralized AI training","Cryptocurrency wallet","Social media platform"], a:1},
{q:"What technology does Gensyn use to coordinate compute resources?", options:["Blockchain","Quantum computing","Cloud servers","IoT networks"], a:0},
{q:"Which type of network does Gensyn leverage?", options:["Centralized servers","Peer-to-peer network","Virtual LANs","Hybrid cloud"], a:1},
{q:"Gensyn allows users to contribute what resource?", options:["Internet bandwidth","Storage only","GPU/compute power","Domain names"], a:2},
{q:"What is the native token of Gensyn used for incentives?", options:["ETH","BTC","GEN","GENS"], a:3},
{q:"Gensyn is built to support which kind of workloads?", options:["Image editing","Artificial Intelligence / ML training","File hosting","Database queries"], a:1},
{q:"What does Gensynâ€™s decentralized model aim to reduce?", options:["Gaming latency","Energy cost of AI training","Centralized control of AI infrastructure","File corruption"], a:2},
{q:"Which consensus mechanism does Gensyn rely on for task verification?", options:["Proof-of-Work","Proof-of-Stake","Proof-of-Compute","Proof-of-Storage"], a:2},
{q:"Gensyn aims to make AI training moreâ€¦", options:["Expensive","Centralized","Accessible","Secretive"], a:2},
{q:"What problem in AI infrastructure does Gensyn solve?", options:["Lack of software","Lack of decentralized compute access","Lack of users","Lack of data"], a:1},
{q:"Who can join Gensyn as a contributor?", options:["Only big data centers","Only government labs","Anyone with spare GPU/compute","Only universities"], a:2},
{q:"How does Gensyn ensure tasks are computed correctly?", options:["Random checks","Smart contract-based verification","Manual audits","User voting"], a:1},
{q:"Which of these is a key benefit of Gensyn?", options:["Centralized pricing","Trustless verification","Limited scalability","Hardware ownership requirement"], a:1},
{q:"Gensyn is especially useful for which type of AI models?", options:["Small toy models","Large-scale deep learning models","Only NLP models","Only computer vision models"], a:1},
{q:"What role do GENs tokens play?", options:["Only governance","Incentives + payments","Marketing","Security only"], a:1},
{q:"Which layer does Gensyn operate on?", options:["Blockchain infrastructure layer","Application layer for AI compute","Networking hardware layer","Security monitoring layer"], a:1},
{q:"Gensyn reduces reliance on which type of providers?", options:["Open-source frameworks","Centralized cloud giants","Universities","Local ISPs"], a:1},
{q:"How are contributors rewarded in Gensyn?", options:["Lottery system","GENs tokens based on compute contributed","Free internet data","Gift cards"], a:1},
{q:"Which industry is most impacted by Gensyn?", options:["Retail","Artificial Intelligence & Machine Learning","Banking","Tourism"], a:1},
{q:"What ensures fairness in Gensynâ€™s compute market?", options:["Manual pricing","Decentralized incentive system","Central authority","Random billing"], a:1},
{q:"What type of marketplace is Gensyn?", options:["NFT marketplace","Compute marketplace","Social media marketplace","File marketplace"], a:1},
{q:"Gensynâ€™s main innovation isâ€¦", options:["Token farming","Blockchain-verified AI training","Cheap cloud storage","Game streaming"], a:1},
{q:"Which of these companies would most benefit from Gensyn?", options:["A video editing startup","A deep learning research lab","A restaurant chain","A clothing store"], a:1},
{q:"What does Gensyn democratize?", options:["Social media posting","AI compute access","Online payments","Music streaming"], a:1},
{q:"The vision of Gensyn is toâ€¦", options:["Make AI training accessible to everyone","Replace the internet","Build a new cryptocurrency only","Control centralized AI companies"], a:0}
];

/* ===== State & elements ===== */
let available = []; // shuffled question indices
let curIndex = 0;
let score = 0, correct = 0, attempted = 0, streak = 0, bestStreak = 0;
const totalQ = QUESTIONS.length;

const el = id => document.getElementById(id);
const optionsWrap = el('options');
const qEl = el('question');
const startBtn = el('startBtn');
const nextBtn = el('nextBtn');
const endBtn = el('endBtn');
const scoreEl = el('score');
const correctEl = el('correct');
const attemptedEl = el('attempted');
const progressEl = el('progress');
const winningRateEl = el('winningRate');
const modal = el('modal');
const leaderBtn = el('leaderBtn');
const boardTableBody = document.querySelector('#boardTable tbody');
const closeModal = el('closeModal');
const saveScoreBtn = el('saveScore');
const nameInput = el('nameInput');
const clearBoardBtn = el('clearBoard');
const exportBtn = el('exportBtn');
const importBtn = el('importBtn');
const shareBtn = el('shareBtn');
const resetBtn = el('resetBtn');
const streakEl = el('streak');

/* ===== Audio using WebAudio API (no external files) ===== */
const AudioContext = window.AudioContext || window.webkitAudioContext;
const audioCtx = AudioContext ? new AudioContext() : null;

function playTone(f=440, t=0.06, type='sine', vol=0.12){
  if(!audioCtx) return;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = type; o.frequency.value = f;
  g.gain.value = vol;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + t);
  o.stop(audioCtx.currentTime + t + 0.02);
}
function soundClick(){ playTone(880,0.04,'triangle',0.06); }
function soundCorrect(){ playTone(1200,0.18,'sine',0.12); playTone(1600,0.08,'sine',0.06); }
function soundWrong(){ playTone(220,0.18,'sawtooth',0.12); }
function soundWin(){ playTone(420,0.2,'sine',0.12); playTone(660,0.16,'sine',0.12); playTone(880,0.08,'sine',0.08); }

/* ===== confetti simple engine ===== */
const confettiCanvas = el('confetti');
const ctx = confettiCanvas.getContext('2d');
let confettiList = [];
function resizeCanvas(){ confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function spawnConfetti(count=60){
  confettiList = [];
  for(let i=0;i<count;i++){
    confettiList.push({
      x: Math.random()*confettiCanvas.width,
      y: -Math.random()*200,
      vx: (Math.random()-0.5)*6,
      vy: 2+Math.random()*6,
      size: 6 + Math.random()*10,
      rot: Math.random()*360,
      spin: (Math.random()-0.5)*8,
      color: `hsl(${Math.floor(Math.random()*350)},80%,60%)`
    });
  }
  let t=0;
  function frame(){
    t++;
    ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
    confettiList.forEach(p=>{
      p.x += p.vx; p.y += p.vy; p.rot += p.spin;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot*Math.PI/180);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
      ctx.restore();
    });
    confettiList = confettiList.filter(p=> p.y < confettiCanvas.height + 50);
    if(confettiList.length && t<300){ requestAnimationFrame(frame); } else { ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height); }
  }
  frame();
}

/* ===== utility ===== */
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }
function saveState(){ localStorage.setItem('spike_quiz_state', JSON.stringify({score,correct,attempted,streak,bestStreak})); }
function loadState(){ const s = JSON.parse(localStorage.getItem('spike_quiz_state')||'null'); if(s){ score=s.score||0; correct=s.correct||0; attempted=s.attempted||0; streak=s.streak||0; bestStreak=s.bestStreak||0; updateHUD(); }}

/* ===== leaderboard storage (localStorage) ===== */
function getBoard(){ return JSON.parse(localStorage.getItem('spike_leaderboard')||'[]'); }
function setBoard(b){ localStorage.setItem('spike_leaderboard', JSON.stringify(b)); }
function addBoardEntry(name, scoreVal, correctVal, rateVal){
  const b = getBoard();
  b.push({name,score:scoreVal,correct:correctVal,rate:rateVal, ts:Date.now()});
  b.sort((a,b2)=> b2.score - a.score || b2.correct - a.correct);
  setBoard(b.slice(0,200)); // keep top 200
  renderLeaderboard();
}

/* ===== UI rendering ===== */
function renderLeaderboard(){
  const rows = getBoard();
  boardTableBody.innerHTML = rows.map((r,i)=>`<tr>
    <td>${i+1}</td>
    <td>${escapeHtml(r.name)}</td>
    <td>${r.score}</td>
    <td>${r.correct}</td>
    <td>${r.rate}%</td>
  </tr>`).join('') || '<tr><td colspan="5" style="text-align:center;color:var(--muted)">No entries yet</td></tr>';
}

function escapeHtml(s){ return String(s||'').replace(/[&<>"]/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' })[c]); }

/* ===== quiz logic ===== */
function startQuiz(){
  // shuffle question indices
  available = shuffle(Array.from({length:totalQ}, (_,i)=>i));
  curIndex = 0; score=0; correct=0; attempted=0;
  updateHUD();
  showQuestion();
  startBtn.style.display='none';
  nextBtn.style.display='none';
  endBtn.style.display='';
  soundClick();
}

function showQuestion(){
  const qi = available[curIndex];
  const data = QUESTIONS[qi];
  qEl.textContent = `${curIndex+1}. ${data.q}`;
  optionsWrap.innerHTML = '';
  const order = shuffle([0,1,2,3]);
  order.forEach((optI, idx)=>{
    const btn = document.createElement('button');
    btn.className = 'option';
    btn.innerHTML = `<div style="display:flex;align-items:center;gap:10px"><div style="width:36px;height:36px;border-radius:10px;background:linear-gradient(90deg,var(--accent2),var(--accent1));display:grid;place-items:center;font-weight:800">${String.fromCharCode(65+idx)}</div><div>${escapeHtml(data.options[optI])}</div></div>`;
    btn.dataset.answerIndex = optI;
    btn.addEventListener('click', onOptionClick);
    optionsWrap.appendChild(btn);
  });

  progressEl.style.width = `${Math.round((curIndex/totalQ)*100)}%`;
  nextBtn.style.display = 'none';
  attemptedEl.textContent = attempted;
}

function onOptionClick(e){
  const btn = e.currentTarget;
  if(btn.classList.contains('disabled')) return;
  // disable all
  Array.from(optionsWrap.children).forEach(b=> b.classList.add('disabled'));
  const selected = Number(btn.dataset.answerIndex);
  const qi = available[curIndex];
  const data = QUESTIONS[qi];
  attempted++;
  attemptedEl.textContent = attempted;
  if(selected === data.a){
    btn.classList.add('correct');
    score += Math.max(10, Math.round(100/totalQ)); // dynamic scoring
    correct++;
    streak++;
    bestStreak = Math.max(bestStreak, streak);
    soundCorrect();
  } else {
    btn.classList.add('wrong');
    // reveal correct
    Array.from(optionsWrap.children).forEach(b=>{
      if(Number(b.dataset.answerIndex) === data.a) b.classList.add('correct');
    });
    streak = 0;
    soundWrong();
  }
  scoreEl.textContent = score;
  correctEl.textContent = correct;
  streakEl.textContent = streak;
  saveState();
  // show next or finish
  if(curIndex < totalQ-1){
    setTimeout(()=> { nextBtn.style.display='inline-block'; }, 600);
  } else {
    setTimeout(()=> { finishQuiz(); }, 900);
  }
}

function nextQuestion(){
  curIndex++;
  if(curIndex < totalQ) showQuestion();
  else finishQuiz();
}

function finishQuiz(){
  progressEl.style.width = `100%`;
  // show result panel
  const rate = attempted ? Math.round((correct/attempted)*100) : 0;
  winningRateEl.textContent = `${rate}%`;
  // show share options and confetti if passed threshold
  if(rate >= 70){
    spawnConfetti(120);
    soundWin();
  } else {
    playTone(200,0.08,'sawtooth',0.08);
  }
  // allow leaderboard save
  saveLastResult();
  // reset UI
  nextBtn.style.display = 'none';
  endBtn.style.display = 'none';
  startBtn.style.display = '';
  startBtn.textContent = 'Restart Quiz';
}

function saveLastResult(){
  const rate = attempted ? Math.round((correct/attempted)*100) : 0;
  // store last result for sharing
  localStorage.setItem('spike_last_result', JSON.stringify({
    ts:Date.now(), score, correct, attempted, rate
  }));
}

/* ===== leaderboard modal actions ===== */
leaderBtn.addEventListener('click', ()=> {
  modal.classList.add('show'); renderLeaderboard();
});
closeModal.addEventListener('click', ()=> modal.classList.remove('show'));
saveScoreBtn.addEventListener('click', ()=>{
  const name = (nameInput.value||'Anonymous').trim().slice(0,32);
  const last = JSON.parse(localStorage.getItem('spike_last_result')||'null');
  if(!last){ alert('No recent result to save. Take a quiz first!'); return; }
  addBoardEntry(name, last.score, last.correct, last.rate);
  soundClick();
});

/* ===== other controls ===== */
startBtn.addEventListener('click', ()=> { startQuiz(); });
nextBtn.addEventListener('click', ()=> { nextQuestion(); playTone(660,0.06,'sine',0.08); });
endBtn.addEventListener('click', ()=> { if(confirm('End quiz early?')) finishQuiz(); });

clearBoardBtn.addEventListener('click', ()=> {
  if(confirm('Clear leaderboard? This cannot be undone.')){ setBoard([]); renderLeaderboard(); soundClick(); }
});

exportBtn.addEventListener('click', ()=> {
  const data = JSON.stringify(getBoard(), null, 2);
  const blob = new Blob([data], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'spike_leaderboard.json';
  a.click();
  URL.revokeObjectURL(url);
  soundClick();
});

importBtn.addEventListener('click', ()=> {
  const file = document.createElement('input');
  file.type = 'file'; file.accept='.json,application/json';
  file.onchange = ()=> {
    const f = file.files[0];
    if(!f) return;
    const r = new FileReader();
    r.onload = ()=> {
      try{
        const parsed = JSON.parse(r.result);
        if(Array.isArray(parsed)){
          setBoard(parsed);
          renderLeaderboard();
          alert('Imported successfully.');
        } else alert('Invalid leaderboard format.');
      }catch(e){ alert('Import failed: ' + e.message); }
    };
    r.readAsText(f);
  };
  file.click(); soundClick();
});

shareBtn.addEventListener('click', ()=>{
  const last = JSON.parse(localStorage.getItem('spike_last_result')||'null');
  if(!last){ alert('No results yet â€” take the quiz first.'); return; }
  const msg = `I scored ${last.score} on the Gensyn Ã— SpikeXYZ quiz! ${last.correct}/${last.attempted} correct (${last.rate}%). Try it:`;
  // share via Web Share API if available (mobile)
  if(navigator.share){
    navigator.share({ title:'Gensyn Ã— SpikeXYZ Quiz', text: msg, url: location.href }).catch(()=>{});
  } else {
    // fallback: show choices for telegram/twitter/whatsapp
    const enc = encodeURIComponent(msg + ' ' + location.href);
    const choices = [
      {name:'Twitter', url:`https://twitter.com/intent/tweet?text=${enc}`},
      {name:'Telegram', url:`https://t.me/share/url?url=${encodeURIComponent(location.href)}&text=${encodeURIComponent(msg)}`},
      {name:'WhatsApp', url:`https://api.whatsapp.com/send?text=${enc}`}
    ];
    const c = choices.map(ch=>`[${ch.name}](${ch.url})`).join(' ');
    // open in new tab (twitter/telegram/whatsapp)
    window.open(choices[0].url,'_blank');
  }
  soundClick();
});

resetBtn.addEventListener('click', ()=> {
  if(confirm('Reset your local progress and last result?')){
    score=0;correct=0;attempted=0;streak=0;bestStreak=0;saveState();
    localStorage.removeItem('spike_last_result');
    updateHUD();
    renderLeaderboard();
  }
});

/* ===== helpers & persistence ===== */
function updateHUD(){
  scoreEl.textContent = score;
  correctEl.textContent = correct;
  attemptedEl.textContent = attempted;
  streakEl.textContent = streak;
  const rate = attempted? Math.round((correct/attempted)*100) : 0;
  winningRateEl.textContent = `${rate}%`;
}

/* ===== initial load ===== */
loadState();
renderLeaderboard();
updateHUD();

/* ===== small UX niceties: keyboard support and safe-touch ===== */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'n') nextQuestion();
  if(e.key === 'Escape') modal.classList.remove('show');
});

/* ===== keep UI lively: small animated gradient behind options ===== */
setInterval(()=>{
  document.documentElement.style.setProperty('--accent1', `#ff2da8`);
  document.documentElement.style.setProperty('--accent2', `#7b3cff`);
}, 4000);

</script>
</body>
  </html>
